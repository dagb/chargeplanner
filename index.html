<!DOCTYPE html PUBLIC
        "-//W3C//DTD XHTML 1.1 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html>
<head>
  <script src="chargeplanner.js" type="text/javascript"></script>
  <script type="text/javascript" src="node_modules/moment/moment.js"></script>
</head>

<body>
<h1>Find start time for charging your Tesla Model S</h1>
In order to minimize the time the battery has a high SOC, the finding the time to start charging is essential.<br>
Having high SOC for longer periods of time is not recommended for good battery health.<br/>
This calculation is simplified and assumes linear charging. <br>
More powerful chargers will not be fully utilized when the battery is cold or when SOC is high.
  <fieldset>
  <label for="power">Charging power (kW)</label>
  <input type="text" id="power"/>
  <label for="unit">Unit</label>
  <select id="unit">
    <option value="%">%</option>
    <option value="tkm">tkm</option>
  </select>
  <label for="soc-current">Current SOC</label>
	<input type="text" id="soc-current"/>
  <label for="soc-target">Target SOC</label>
  <input type="text" id="soc-target"/>
  <label for="target-time">Charging finished</label>
  <input type="text" id="target-time"/>
  </fieldset>
  <br>
  <fieldset>
  <label for="charge-time">Charging time</label>
	<input type="text" id="charge-time" disabled="disabled"/>
  <label for="charge-time">Start to charge</label>
  <input type="text" id="start-time" disabled="disabled"/>
  </fieldset>
  <br>
	<button type="button" value="Calculate" title="Calculate starte time" onclick="startCharge(); ">
    Calculate
  </button>

<script type="text/javascript">
  function startCharge() {
    var power = document.getElementById('power').value;
    var unit = document.getElementById('unit').value;
    var socCurrent = document.getElementById('soc-current').value;
    var socTarget = document.getElementById('soc-target').value;

    var hours = chargeTime(document.getElementById('soc-current').value, socTarget, power, unit);
    var hoursDuration = moment.duration(hours, 'hours');
    document.getElementById('charge-time').value = hoursDuration.humanize();

    var targetTime = moment().startOf('day').add(1, 'days');

    targetTime = targetTime.add(moment.duration(document.getElementById("target-time").value));
    var startTime = targetTime.subtract(hoursDuration);
    document.getElementById('start-time').value = startTime.format("DD.MM.YYYY HH:mm");
  }
</script>
</body>
</html>
